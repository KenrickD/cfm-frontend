@model cfm_frontend.Models.PagingInfo
@{
    var currentUrl = Context.Request.Path.ToString();
    var queryParams = Context.Request.Query.ToDictionary(
        kvp => kvp.Key,
        kvp => kvp.Value.ToString()
    );
    queryParams.Remove("page");

    string BuildUrl(int pageNumber)
    {
        queryParams["page"] = pageNumber.ToString();
        var query = string.Join("&", queryParams.Select(kvp => $"{Uri.EscapeDataString(kvp.Key)}={Uri.EscapeDataString(kvp.Value)}"));
        return $"{currentUrl}?{query}";
    }
}

@if (Model != null && Model.TotalPages > 0)
{
    <div class="pagination-wrapper">
        <div class="pagination-info text-center mb-3">
            <span class="text-muted">
                Showing <strong>@((Model.CurrentPage - 1) * Model.PageSize + 1)</strong>
                to <strong>@(Math.Min(Model.CurrentPage * Model.PageSize, Model.TotalCount))</strong>
                of <strong>@Model.TotalCount</strong> results
            </span>
        </div>

        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                @* Previous Button *@
                <li class="page-item @(!Model.HasPreviousPage ? "disabled" : "")">
                    @if (Model.HasPreviousPage)
                    {
                        <a class="page-link" href="@BuildUrl(Model.CurrentPage - 1)" aria-label="Previous">
                            <span aria-hidden="true">
                                <i class="ti ti-chevron-left"></i>
                                Previous
                            </span>
                        </a>
                    }
                    else
                    {
                        <span class="page-link" aria-disabled="true">
                            <span aria-hidden="true">
                                <i class="ti ti-chevron-left"></i>
                                Previous
                            </span>
                        </span>
                    }
                </li>

                @* Page Numbers *@
                @foreach (var pageNumber in Model.GetPageNumbers())
                {
                    if (pageNumber == -1)
                    {
                        <li class="page-item disabled">
                            <span class="page-ellipsis">...</span>
                        </li>
                    }
                    else
                    {
                        <li class="page-item @(pageNumber == Model.CurrentPage ? "active" : "")">
                            @if (pageNumber == Model.CurrentPage)
                            {
                                <span class="page-link">@pageNumber</span>
                            }
                            else
                            {
                                <a class="page-link" href="@BuildUrl(pageNumber)">@pageNumber</a>
                            }
                        </li>
                    }
                }

                @* Next Button *@
                <li class="page-item @(!Model.HasNextPage ? "disabled" : "")">
                    @if (Model.HasNextPage)
                    {
                        <a class="page-link" href="@BuildUrl(Model.CurrentPage + 1)" aria-label="Next">
                            <span aria-hidden="true">
                                Next
                                <i class="ti ti-chevron-right"></i>
                            </span>
                        </a>
                    }
                    else
                    {
                        <span class="page-link" aria-disabled="true">
                            <span aria-hidden="true">
                                Next
                                <i class="ti ti-chevron-right"></i>
                            </span>
                        </span>
                    }
                </li>
            </ul>
        </nav>
    </div>

    <style>
        .pagination-wrapper {
            margin-top: 20px;
        }

        .pagination-info {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .pagination {
            margin: 0;
        }

        .pagination .page-link {
            border-radius: 6px;
            margin: 0 3px;
            border: 1px solid #dee2e6;
            color: #495057;
            min-width: 40px;
            text-align: center;
            transition: all 0.2s ease;
        }

        .pagination .page-item.active .page-link {
            background-color: #04a9f5;
            border-color: #04a9f5;
            color: white;
            font-weight: 600;
        }

        .pagination .page-item.disabled .page-link {
            background-color: #f8f9fa;
            border-color: #dee2e6;
            color: #6c757d;
            cursor: not-allowed;
        }

        .pagination .page-link:hover:not(.active):not([aria-disabled="true"]) {
            background-color: #e9ecef;
            border-color: #dee2e6;
            color: #495057;
        }

        .pagination .page-ellipsis {
            padding: 0.375rem 0.75rem;
            margin: 0 3px;
            color: #6c757d;
        }
    </style>
}
